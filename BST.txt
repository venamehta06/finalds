#include <stdio.h>
#include <stdlib.h>

struct node {
    int data;
    struct node *left, *right;
};

struct node* insert(struct node *r, int x)
{
    if (r == NULL)
    {
        r = (struct node*)malloc(sizeof(struct node));
        r->data = x;
        r->left = r->right = NULL;
        return r;
    }
    if (x < r->data) r->left = insert(r->left, x);
    else if (x > r->data) r->right = insert(r->right, x);
    return r;
}

struct node* delete(struct node *r, int x)
{
    if (r == NULL) return r;

    if (x < r->data) r->left = delete(r->left, x);
    else if (x > r->data) r->right = delete(r->right, x);
    else
    {
        if (r->left == NULL)
        {
            struct node *t = r->right;
            free(r);
            return t;
        }
        if (r->right == NULL)
        {
            struct node *t = r->left;
            free(r);
            return t;
        }

        struct node *t = r->right;
        while (t->left) t = t->left;
        r->data = t->data;
        r->right = delete(r->right, t->data);
    }
    return r;
}

void display(struct node *r)
{
    if (r)
    {
        display(r->left);
        printf("%d ", r->data);
        display(r->right);
    }
}

int main()
{
    struct node *root = NULL;
    int ch, x;

    do
    {
        printf("\n1.Insert 2.Delete 3.Display 4.Exit\n");
        scanf("%d", &ch);

        if (ch == 1)
        {
            scanf("%d", &x);
            root = insert(root, x);
        }
        else if (ch == 2)
        {
            scanf("%d", &x);
            root = delete(root, x);
        }
        else if (ch == 3)
            display(root);

    } while (ch != 4);

    return 0;
}
